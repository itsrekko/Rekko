"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UsersRestAPIStack = void 0;
const healthLambda_1 = require("../lambdas/healthLambda/healthLambda");
const aws_apigateway_1 = require("aws-cdk-lib/aws-apigateway");
exports.UsersRestAPIStack = (parent) => {
    // deploy the lambdas first
    const healthLambda = healthLambda_1.HealthLambda(parent);
    const restAPI = new aws_apigateway_1.RestApi(parent, 'RekkoUsersRestAPI', {
        description: 'Rest API for Rekko User Info',
    });
    restAPI.root.addMethod('ANY');
    const fetchUsers = restAPI.root.addResource('getAllUsers');
    const createUsers = restAPI.root.addResource('checkAndCreateNewUser');
    fetchUsers.addMethod('GET', new aws_apigateway_1.LambdaIntegration(healthLambda), {
        operationName: 'getAllUsers',
        authorizationType: aws_apigateway_1.AuthorizationType.NONE,
    });
    createUsers.addMethod('GET', new aws_apigateway_1.LambdaIntegration(healthLambda), {
        operationName: 'getAllUsers',
        authorizationType: aws_apigateway_1.AuthorizationType.NONE,
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlcnMtcmVzdC1hcGktc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1c2Vycy1yZXN0LWFwaS1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSx1RUFBb0U7QUFDcEUsK0RBQTJGO0FBRTlFLFFBQUEsaUJBQWlCLEdBQUcsQ0FBQyxNQUFnQixFQUFFLEVBQUU7SUFDbEQsMkJBQTJCO0lBQzNCLE1BQU0sWUFBWSxHQUFHLDJCQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDMUMsTUFBTSxPQUFPLEdBQUcsSUFBSSx3QkFBTyxDQUFDLE1BQU0sRUFBRSxtQkFBbUIsRUFDdkQ7UUFDSSxXQUFXLEVBQUUsOEJBQThCO0tBQzlDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRTlCLE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzNELE1BQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFFdEUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxrQ0FBaUIsQ0FBQyxZQUFZLENBQUMsRUFBRTtRQUM3RCxhQUFhLEVBQUUsYUFBYTtRQUM1QixpQkFBaUIsRUFBRSxrQ0FBaUIsQ0FBQyxJQUFJO0tBQzVDLENBQUMsQ0FBQztJQUVILFdBQVcsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLElBQUksa0NBQWlCLENBQUMsWUFBWSxDQUFDLEVBQUU7UUFDOUQsYUFBYSxFQUFFLGFBQWE7UUFDNUIsaUJBQWlCLEVBQUUsa0NBQWlCLENBQUMsSUFBSTtLQUM1QyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0Nka1N0YWNrfSBmcm9tICcuLi9jZGstc3RhY2snO1xyXG5pbXBvcnQgeyBIZWFsdGhMYW1iZGEgfSBmcm9tICcuLi9sYW1iZGFzL2hlYWx0aExhbWJkYS9oZWFsdGhMYW1iZGEnO1xyXG5pbXBvcnQgeyBBdXRob3JpemF0aW9uVHlwZSwgTGFtYmRhSW50ZWdyYXRpb24sIFJlc3RBcGkgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYXBpZ2F0ZXdheSc7XHJcblxyXG5leHBvcnQgY29uc3QgVXNlcnNSZXN0QVBJU3RhY2sgPSAocGFyZW50OiBDZGtTdGFjaykgPT4ge1xyXG4gICAgLy8gZGVwbG95IHRoZSBsYW1iZGFzIGZpcnN0XHJcbiAgICBjb25zdCBoZWFsdGhMYW1iZGEgPSBIZWFsdGhMYW1iZGEocGFyZW50KTtcclxuICAgIGNvbnN0IHJlc3RBUEkgPSBuZXcgUmVzdEFwaShwYXJlbnQsICdSZWtrb1VzZXJzUmVzdEFQSScsIFxyXG4gICAge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVzdCBBUEkgZm9yIFJla2tvIFVzZXIgSW5mbycsXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXN0QVBJLnJvb3QuYWRkTWV0aG9kKCdBTlknKTtcclxuXHJcbiAgICBjb25zdCBmZXRjaFVzZXJzID0gcmVzdEFQSS5yb290LmFkZFJlc291cmNlKCdnZXRBbGxVc2VycycpO1xyXG4gICAgY29uc3QgY3JlYXRlVXNlcnMgPSByZXN0QVBJLnJvb3QuYWRkUmVzb3VyY2UoJ2NoZWNrQW5kQ3JlYXRlTmV3VXNlcicpO1xyXG5cclxuICAgIGZldGNoVXNlcnMuYWRkTWV0aG9kKCdHRVQnLCBuZXcgTGFtYmRhSW50ZWdyYXRpb24oaGVhbHRoTGFtYmRhKSwge1xyXG4gICAgICAgIG9wZXJhdGlvbk5hbWU6ICdnZXRBbGxVc2VycycsXHJcbiAgICAgICAgYXV0aG9yaXphdGlvblR5cGU6IEF1dGhvcml6YXRpb25UeXBlLk5PTkUsIC8vIFRPIERPIHRoaXMgd291bGQgbmVlZCB0byBjaGFuZ2UgdG8gY29nbml0byBhdXRoXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY3JlYXRlVXNlcnMuYWRkTWV0aG9kKCdHRVQnLCBuZXcgTGFtYmRhSW50ZWdyYXRpb24oaGVhbHRoTGFtYmRhKSwge1xyXG4gICAgICAgIG9wZXJhdGlvbk5hbWU6ICdnZXRBbGxVc2VycycsXHJcbiAgICAgICAgYXV0aG9yaXphdGlvblR5cGU6IEF1dGhvcml6YXRpb25UeXBlLk5PTkUsIC8vIFRPIERPIHRoaXMgd291bGQgbmVlZCB0byBjaGFuZ2UgdG8gY29nbml0byBhdXRoXHJcbiAgICB9KTtcclxufSJdfQ==